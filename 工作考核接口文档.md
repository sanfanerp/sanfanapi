# 工作考核和考核设置 接口文档 v2019.04.17


2019.04.17
```
发布工作考核和考核设置模块接口
```
### 规范说明
域名：
```
接口地址
http://192.168.0.140:8089
swagger
http://192.168.0.140:8089/swagger-ui.html
```
token 验证：
```
需在http请求中添加
token : ****token****
```
http 响应状态码：
```
需要根据不同的状态码，做处理
200: 操作成功。  
500: 系统内部错误。  
401: 未授权，token过期或者无效。 
412: 参数不正确或者前置条件不足。  
501: 程序错误，抛出异常。


```
***
### 目录
1. 获取考核模块列表(编码和中文)
2. 获取考核项列表(某模块)
3. 新增自定义考核项
4. 新增考核规则
5. 考核规则搜索
6. 查询考核规则详情
7. 删除考核规则
8. 获取某人某月的考核分数
9. 获取考核分数详情
10. 考核分数处理(撤销/恢复)

***
### 1. 获取考核模块列表(编码和中文)
#### 描述
获取考核模块列表(编码和中文)
#### 请求
GET: /office/check/modules

#### 响应
```json
[
  {
    "code": "REPORT",
    "name": "汇报"
  },
  {
    "code": "ATTENDANCE",
    "name": "考勤"
  },
  {
    "code": "TASK",
    "name": "任务"
  },
  {
    "code": "DAILY",
    "name": "日报"
  },
  {
    "code": "VISIT",
    "name": "拜访"
  },
  {
    "code": "CUSTOM",
    "name": "自定义"
  }
]
```
<hr />

### 2. 获取考核项列表(某模块)
#### 描述
获取考核项列表(某模块)
#### 请求
GET: /office/check/item/{module}
```
module参数取值范围：
  "REPORT", //汇报
  "ATTENDANCE", //考勤
  "TASK", //任务
  "DAILY", //日报
  "VISIT", //拜访
  "CUSTOM" //自定义

```

#### 响应
```
[
  {
    "id": "10001", 
    "createTime": "2019-04-13 09:05:20",
    "companyId": null,
    "checkModule": "REPORT", //所属模块
    "itemName": "不交汇报", //考核项名称
    "itemSubName": null, //考核项子名称
    "itemNum": null, //考核项条件值
    "scoreType": "SCORE", //考核分数类型：SCORE：分数,SALARY：工资
    "scoreAdd": null, //加分
    "scoreSub": 20,  //扣分
    "period": null  //周期
  },
  {
    "id": "10002",
    "createTime": "2019-04-13 09:05:20",
    "companyId": null,
    "checkModule": "REPORT",
    "itemName": "不阅读汇报",
    "itemSubName": null,
    "itemNum": null,
    "scoreType": "SCORE",
    "scoreAdd": null,
    "scoreSub": 5,
    "period": null
  },
  {
    "id": "10003",
    "createTime": "2019-04-13 09:05:20",
    "companyId": null,
    "checkModule": "REPORT",
    "itemName": "汇报统计中所在部门的数据模板",
    "itemSubName": "根据模板的设置来自定义加减分",
    "itemNum": null,
    "scoreType": "SCORE",
    "scoreAdd": null,
    "scoreSub": null,
    "period": null
  }
]
```
<hr />

### 3. 新增自定义考核项
#### 描述
新增自定义考核项
#### 请求
POST /office/check/item/custom
```
加分请求
{
  "itemName": "修整公物",
  "scoreAdd": 10,
  "scoreType": "SCORE"
}
```
```
扣分请求
{
  "itemName": "破坏公物",
  "scoreSub": 10,
  "scoreType": "SCORE"
}
```
#### 响应
```
200
```
<hr />


### 4. 新增考核规则
#### 描述
新增考核规则
#### 请求
POST /office/check/rule
```
枚举说明：
checkModule参数：
    REPORT("汇报"),
    ATTENDANCE("考勤"),
    TASK("任务"),
    DAILY("日报"),
    VISIT("拜访"),
    CUSTOM("自定义")
    
checkRuleStatus参数:
    UNEXECUTED("未执行"),
    EXECUTING("正在执行"),
    EXECUTED("执行完成")
   
period参数：
    DAY("每天"),
    WEEK("每周"),
    MONTH("每月")
    
scoreType参数：
    SCORE("分数"),
    SALARY("工资")
```
```
请求body示例如下：
{
  "checkModule": "REPORT", //考核模块编码
  "checkRuleStatus": "UNEXECUTED", //规则状态
  "startDate": "2019-04-15", //开始日期
  "endDate": "2019-04-15",  //结束日期
  "name": "考核规则名称",  
  "ruleDetailDTOList": [
    {
      "itemName": "考核项名称",
      "itemNum": 0, //考核项条件值
      "itemSubName": "考核项子名称",
      "period": "DAY", //考核周期
      "scoreAdd": 0, //加分
      "scoreSub": 0, //减分
      "scoreType": "SCORE" //考核分数类型：SCORE：分数,SALARY：工资
    }
  ],
  "rulePersonDTOList": [
    {
      "employeeId": "参与考核员工id"
    }
  ]
}
```
#### 响应
```
200
```
<hr />


### 5. 考核规则搜索
#### 描述
考核规则搜索
#### 请求
POST /office/check/search
```
{
"pageNum":1, //可选参数，页数，从1开始
"pageSize":10, //可选参数， 页大小
"checkModules: [], // 可选参数,考核模块
"startDate":"2019-04-15", //可选参数，开始日期
"endDate":"2019-04-15" //可选参数，结束日期
 }
```
#### 响应

```
{
  "pageNum": 1,
  "pageSize": 1,
  "size": 1,
  "startRow": 0,
  "endRow": 0,
  "total": 1,
  "pages": 1,
  "list": [
    {
      "id": "8a80cb816a1e8dc0016a1e927d3d0000",
      "createTime": "2019-04-15 09:17:58",
      "companyId": "402880086951cc28016951d35f140000",
      "checkModule": "REPORT",
      "name": "考核规则名称",
      "startDate": "2019-04-15",
      "endDate": "2019-04-15",
      "checkRuleStatus": "UNEXECUTED",
      "personNum": 1, //执行人总数
      "rulePersonDTOList": [
        {
          "id": "8a80cb816a1e8dc0016a1e927e810001",
          "createTime": "2019-04-15 09:17:58",
          "checkRuleId": "8a80cb816a1e8dc0016a1e927d3d0000",
          "employeeId": "执行人id",
          "employeeName": "执行人名称",
          "employeeAvatar": "执行人头像"
        }
      ],
      "ruleDetailDTOList": [
        {
          "id": "8a80cb816a1e8dc0016a1e927f250002",
          "createTime": "2019-04-15 09:17:58",
          "checkRuleId": "8a80cb816a1e8dc0016a1e927d3d0000",
          "itemName": "考核项名称",
          "itemSubName": "考核项子名称",
          "itemNum": 0,
          "scoreType": "SCORE",
          "scoreAdd": null,
          "scoreSub": 10,
          "period": "DAY"
        }
      ]
    }
  ],
  "prePage": 0,
  "nextPage": 0,
  "isFirstPage": true,
  "isLastPage": true,
  "hasPreviousPage": false,
  "hasNextPage": false,
  "navigatePages": 8,
  "navigatepageNums": [
    1
  ],
  "navigateFirstPage": 1,
  "navigateLastPage": 1,
  "firstPage": 1,
  "lastPage": 1
}
```

### 6. 查询考核规则详情
#### 描述
查询考核规则详情
#### 请求
GET /office/check/rule/{id}
```
id参数: 考核规则id
```
#### 响应
```
{
  "id": "8a80cb816a1e8dc0016a1e927d3d0000",
  "createTime": "2019-04-15 09:17:58",
  "companyId": "402880086951cc28016951d35f140000",
  "checkModule": "REPORT",
  "name": "考核规则名称",
  "startDate": "2019-04-15",
  "endDate": "2019-04-15",
  "checkRuleStatus": "UNEXECUTED",
  "personNum": 1,
  "rulePersonDTOList": [
    {
      "id": "8a80cb816a1e8dc0016a1e927e810001",
      "createTime": "2019-04-15 09:17:58",
      "checkRuleId": "8a80cb816a1e8dc0016a1e927d3d0000",
      "employeeId": "执行人id",
      "employeeName": "执行人名称",
      "employeeAvatar": "执行人头像"
    }
  ],
  "ruleDetailDTOList": [
    {
      "id": "8a80cb816a1e8dc0016a1e927f250002",
      "createTime": "2019-04-15 09:17:58",
      "checkRuleId": "8a80cb816a1e8dc0016a1e927d3d0000",
      "itemName": "考核项名称",
      "itemSubName": "考核项子名称",
      "itemNum": 0,
      "scoreType": "SCORE",
      "scoreAdd": null,
      "scoreSub": 10,
      "period": "DAY"
    }
  ]
}
```
<hr />


### 7. 删除考核规则
#### 描述
删除考核规则
#### 请求
DELETE /office/check/rule/{id}
```
id参数: 考核规则id
```
#### 响应
```json
200
```
<hr />

### 8. 获取某人某月的考核分数
#### 描述
获取某人某月的考核分数
#### 请求
GET /office/check/score
```
{
"employeeId":"员工id", //可选参数
"month":"2019-04" //可选参数,月份：格式：yyyy-MM
 }
 ```
 
#### 响应
```
{
  "addSocreDetail": {
    "DAILY": [
      {
        "id": "8a80cb816a1ee045016a1ee550610000",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "DAILY",
        "scoreOperator": "PLUS",
        "checkScoreType": "SCORE",
        "score": 10,
        "itemName": "提交日报",
        "itemNum": 0,
        "note": "提交日报扣10分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      }
    ],
    "REPORT": [
      {
        "id": "8a80cb816a1edaa5016a1ede8b1a0000",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "REPORT",
        "scoreOperator": "PLUS",
        "checkScoreType": "SCORE",
        "score": 10,
        "itemName": "提交汇报",
        "itemNum": 0,
        "note": "提交汇报扣10分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      }
    ]
  },
  "totalSocre": {
    "id": "8a80cb816a1e8dc0016a1ebc5ad80003",
    "createTime": "2019-04-15 10:03:42",
    "companyId": "402880086951cc28016951d35f140000",
    "employeeId": "402880086950ab4c016950b1a4460002",
    "month": "2019-04",
    "initScore": 0,
    "addScore": 20,
    "subScore": 30,
    "totalScore": -10,
    "updateDate": "2019-04-15 10:48:26",
    "scoreDetailList": [
      {
        "id": "8a80cb816a1ee045016a1ee550610000",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "DAILY",
        "scoreOperator": "PLUS",
        "checkScoreType": "SCORE",
        "score": 10,
        "itemName": "提交日报",
        "itemNum": 0,
        "note": "提交日报扣10分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      },
      {
        "id": "8a80cb816a1edaa5016a1ede8b1a0000",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "REPORT",
        "scoreOperator": "PLUS",
        "checkScoreType": "SCORE",
        "score": 10,
        "itemName": "提交汇报",
        "itemNum": 0,
        "note": "提交汇报扣10分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      },
      {
        "id": "8a80cb816a1ecd50016a1ed0f2b40000",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "REPORT",
        "scoreOperator": "SUBTRACT",
        "checkScoreType": "SCORE",
        "score": 20,
        "itemName": "未提交汇报",
        "itemNum": 0,
        "note": "未提交汇报扣20分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      },
      {
        "id": "8a80cb816a1e8dc0016a1ebc5b210004",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "REPORT",
        "scoreOperator": "SUBTRACT",
        "checkScoreType": "SCORE",
        "score": 10,
        "itemName": "未提交汇报",
        "itemNum": 0,
        "note": "未提交汇报扣10分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      }
    ]
  },
  "subSocreDetail": {
    "REPORT": [
      {
        "id": "8a80cb816a1ecd50016a1ed0f2b40000",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "REPORT",
        "scoreOperator": "SUBTRACT",
        "checkScoreType": "SCORE",
        "score": 20,
        "itemName": "未提交汇报",
        "itemNum": 0,
        "note": "未提交汇报扣20分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      },
      {
        "id": "8a80cb816a1e8dc0016a1ebc5b210004",
        "createTime": "2019-04-15 10:03:42",
        "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
        "companyId": "402880086951cc28016951d35f140000",
        "employeeId": "402880086950ab4c016950b1a4460002",
        "bizDate": "2019-04-15 01:56:39",
        "checkModule": "REPORT",
        "scoreOperator": "SUBTRACT",
        "checkScoreType": "SCORE",
        "score": 10,
        "itemName": "未提交汇报",
        "itemNum": 0,
        "note": "未提交汇报扣10分",
        "scoreStatus": "NORMAL",
        "updateDate": "2019-04-15 10:48:26"
      }
    ]
  }
}
```
<hr />


### 9. 获取考核分数详情
#### 描述
获取考核分数详情
#### 请求
GET /office/check/score/{id}
```
id:考核分数明细id
```
#### 响应
```json
{
  "id": "8a80cb816a1e8dc0016a1ebc5b210004",
  "createTime": "2019-04-15 10:03:42",
  "checkScoreId": "8a80cb816a1e8dc0016a1ebc5ad80003",
  "companyId": "402880086951cc28016951d35f140000",
  "employeeId": "402880086950ab4c016950b1a4460002",
  "bizDate": "2019-04-15 01:56:39",
  "checkModule": "REPORT",
  "scoreOperator": "SUBTRACT",
  "checkScoreType": "SCORE",
  "score": 10,
  "itemName": "未提交汇报",
  "itemNum": 0,
  "note": "未提交汇报扣10分",
  "scoreStatus": "NORMAL",
  "updateDate": null,
  "processorId": null
}
```
<hr />


### 10. 考核分数处理(撤销/恢复)
#### 描述
考核分数处理(撤销/恢复)
#### 请求
POST /office/check/score/{id}/process
```
id:考核分数明细id
参数说明:
process:操作类型
    CANCEL("撤销"),
    RECOVER("恢复")
```
```
撤销分数请求
{
  "process": "CANCEL" 
}

恢复分数请求
{
  "process": "RECOVER" 
}
```
#### 响应
```json
200
```
<hr />