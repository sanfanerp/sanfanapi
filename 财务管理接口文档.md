# 财务管理 接口文档 v2019.04.07

2019.04.10
```
1、查询列表接口加入分页

```

2019.04.07
```
发布财务管理模块接口
```
### 规范说明
域名：
```
接口地址
http://192.168.0.140:8089
swagger
http://192.168.0.140:8089/swagger-ui.html
```
token 验证：
```
需在http请求中添加
token : ****token****
```
http 响应状态码：
```
需要根据不同的状态码，做处理
200: 操作成功。  
500: 系统内部错误。  
401: 未授权，token过期或者无效。 
412: 参数不正确或者前置条件不足。  
501: 程序错误，抛出异常。


```
***
### 目录
1. 获取公司所有财务单据列表
2. 新增财务单据
3. 查询记账方式
4. 新增记账方式
5. 获取我的审批列表
6. 获取公司财务单据列表
7. 导出公司财务单据列表
8. 获取我发起的财务审批列表
9. 财务单据审批处理
10. 财务单据结果处理
11. 财务单据详细搜索
12. 公司总账余额
13. 获取公司总账列表
14. 导出公司总账列表
15. 公司总账详细搜索
16. 获取公司总账详情(by 公司总账id)
17. 获取财务单据详情(by 财务单据id)
***
### 1. 获取公司的所有财务单据列表
#### 描述
查询公司的所有财务单据数据,支持分页查询
#### 请求
POST: /finace/bill/query
```
参数
{
"pageNum":1, //可选参数 页数，从1开始
"pageSize":10 //可选参数 页大小，可选参数
}
```
#### 响应
```json
[
   {
     "id": "4028804069e793a10169e79a3ef30004",
     "createTime": "2019-04-04 17:07:19",
     "bizType": "YS,单据类型，请查看枚举说明",
     "title": "自定义财务录入的标题",
     "bizNo": "编号",
     "dcFlag": "DEBIT，借贷标记，请查看枚举说明",
     "amount": 1000.01,
     "payType": "支付方式",
     "price": 20,
     "num": 200,
     "voucherWord": "凭证字",
     "voucherNo": "凭证号",
     "category": "类别",
     "bizDate": "2019-04-03 12:10:21 ,业务日期",
     "dealing": "来往业务",
     "chargeType": "记账方式",
     "keyword": "关键词",
     "photos": [
       "图片"
     ],
     "customer": "客户",
     "remark": "摘要(用途)",
     "subject": "科目",
     "companyId": "公司id",
     "operatorId": "经办人id",
     "listerId": "制表人id",
     "auditorId": "审核人id",
     "approverId": "审批人id",
     "cashierId": "出纳人id",
     "billProcessId": "当前单据审批流程id",
     "status": "PASSED，单据状态，请参考枚举类型说明",
     "billProcessDTOList": [
       {
         "id": "4028804069e793a10169e79a3f2d0005",
         "createTime": "2019-04-04 17:07:19",
         "billId": "单据id",
         "processorId": "处理人id",
         "processTime": null,
         "processStage": "LISTER,处理人阶段，请参考枚举类型说明",
         "processResult": "APPROVING，处理结果，请参考枚举类型说明",
         "processStatus": "NOTSTART，审批状态，请参考枚举类型说明",
         "note": "审批意见",
         "nextBillProcessId": null
       },
       {
         "id": "4028804069e793a10169e79a3f2e0006",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "402880086950ab4c016950b1a4460002",
         "processTime": null,
         "processStage": "OPERATOR",
         "processResult": "APPROVING",
         "processStatus": "NOTSTART",
         "note": null,
         "nextBillProcessId": null
       },
       {
         "id": "4028804069e793a10169e79a3f2e0007",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "40288008695210f801695218b7d60000",
         "processTime": "2019-04-04 17:08:39",
         "processStage": "AUDITOR",
         "processResult": "APPROVED",
         "processStatus": "COMPLETE",
         "note": "同意",
         "nextBillProcessId": "4028804069e793a10169e79a3f2f0008"
       },
       {
         "id": "4028804069e793a10169e79a3f2f0008",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "4028800869524c8c0169524dfe2b0000",
         "processTime": "2019-04-04 17:09:01",
         "processStage": "APPROVER",
         "processResult": "APPROVED",
         "processStatus": "COMPLETE",
         "note": "同意",
         "nextBillProcessId": "4028804069e793a10169e79a3f2f0009"
       },
       {
         "id": "4028804069e793a10169e79a3f2f0009",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "4028800869525e960169557a35920000",
         "processTime": "2019-04-04 17:09:14",
         "processStage": "CASHIER",
         "processResult": "APPROVED",
         "processStatus": "COMPLETE",
         "note": "同意",
         "nextBillProcessId": null
       }
     ]
   }
 ]
```
<hr />

### 2. 新增财务单据
#### 描述
新增财务单据
#### 请求
POST: /finace/bill
```json
{
  "amount": 1000.01,
  "approverId": "审批人id",
  "auditorId": "审核人id",
  "billProcessDTOList": [
    {
      "processStage": "LISTER，处理人阶段，请查看枚举说明",
      "processorId": "处理人id"
    },
	 {
      "processStage": "OPERATOR,处理人阶段，请查看枚举说明",
      "processorId": "处理人id"
    },
	 {
      "processStage": "AUDITOR,处理人阶段，请查看枚举说明",
      "processorId": "处理人id"
    },  
	{
      "processStage": "APPROVER,处理人阶段，请查看枚举说明",
      "processorId": "处理人id"
    },
	{
      "processStage": "CASHIER,处理人阶段，请查看枚举说明",
      "processorId": "处理人id"
    }
  ],
  "bizDate": "2019-04-03 12:10:21，业务日期",
  "bizType": "YS，单据类别，请查看枚举说明",
  "cashierId": "出纳人id",
  "category": "类别",
  "chargeType": "记账方式",
  "customer": "客户",
  "dealing": "来往业务",
  "keyword": "关键词",
  "listerId": "制表人id",
  "num": 200,
  "operatorId": "经办人id",
  "payType": "结账方式",
  "photos": ["图片"],
  "price": 20,
  "remark": "摘要(用途)",
  "subject": "科目",
  "title": "自定义财务录入的标题",
  "voucherNo": "凭证号",
  "voucherWord": "凭证字"
}
```
```
枚举类型说明：
bizType:(单据类型)
    YF("应付账款"),
    YS("应收账款"),
    LS("收入账款"),
    LC("支出账款"),
    LO("自定义账款"),
    GZ("固定支出"),
    BX("费用报销")
dcFlag:(借贷标记)
     DEBIT("收入"),
     CREDIT("支出"),
     CUSTOM("记账")
 status:(单据状态)
     //消费报销的状态值-UNDERWAY,CALLBACK
     UNDERWAY("进行中"),
     CALLBACK("已撤回"),
     //财务模块的状态值
     APPROVING("待审批"),
     CONFIRMING("确认中"),
     CANCELED("已撤回"),
     REJECTED("已驳回"),
     PASSED("已完成");
  processStage:(处理阶段)
      //费用报销模块的值：
      CHECK("审核"),
      APPROVE("审批"),
      CASH("出纳"),
      //财务模块的值：
      LISTER("制表"),
      OPERATOR("经办"),
      AUDITOR("审核"),
      APPROVER("审批"),
      CASHIER("出纳")
   processResult:(处理结果)
       //费用报销模块的状态值：UNAPPROVED
       UNAPPROVED("未审批"),
       //财务模块的状态值：
       APPROVING("待审批"),
       APPROVED("已审批"),
       REJECTED("已驳回"),
       CANCELED("已撤回")
   ProcessStatus：(流程处理状态)
       NOTSTART("未开始"),
       PROCESSING("待处理"),
       COMPLETE("已处理")
```
#### 响应
```
200
```
<hr />

### 3. 查询记账方式
#### 描述
查询记账方式
#### 请求
GET /finace/bill/chargetype

#### 响应
```json
[
  {
    "id": "4028804069f6f27b0169f6fcc3410000",
    "createTime": "2019-04-07 16:49:14",
    "name": "记账方式名称",
    "companyId": "公司id",
    "employeeId": "员工id"
  }
]
```
<hr />


### 4. 新增记账方式
#### 描述
新增记账方式
#### 请求
POST /finace/bill/chargetype
```json
{
  "name": "记账方式名称"
}
```
#### 响应
```
200
```
<hr />


### 5. 获取我的审批列表
#### 描述
获取我的审批列表，支持分页
#### 请求
POST /finace/bill/myApprove
```
{
"pageNum":1, //可选参数，页数，从1开始
"pageSize":10 //可选参数， 页大小
"isProcessing: false // 可选参数,是否待审批 true:已审批 ,false:待审批
 }
```
#### 响应
```
  同单据查询解决返回对象，请关联查看。
```
```json
[
  {
    "id": "4028804069e793a10169e79a3ef30004",
    "createTime": "2019-04-04 17:07:19",
    "bizType": "YS",
    "title": "",
    "bizNo": "YS4028804069e793a10169e79a3ef30004",
    "dcFlag": "DEBIT",
    "amount": 1000.01,
    "payType": "微信支付",
    "price": 20,
    "num": 200,
    "voucherWord": "凭证字11",
    "voucherNo": "xx00000",
    "category": "出货",
    "bizDate": "2019-04-03 12:10:21",
    "dealing": "xx往来",
    "chargeType": "记账方式1",
    "keyword": "出货收款",
    "photos": [
      ""
    ],
    "customer": "深圳某品牌",
    "remark": "我的应收",
    "subject": "科目xx",
    "companyId": "402880086951cc28016951d35f140000",
    "operatorId": "402880086950ab4c016950b1a4460002",
    "listerId": "402880086950ab4c016950b1a4460002",
    "auditorId": "40288008695210f801695218b7d60000",
    "approverId": "4028800869524c8c0169524dfe2b0000",
    "cashierId": "4028800869525e960169557a35920000",
    "billProcessId": "4028804069e793a10169e79a3f2f0009",
    "status": "PASSED",
    "billProcessDTOList": [
      {
        "id": "4028804069e793a10169e79a3f2f0009",
        "createTime": "2019-04-04 17:07:19",
        "billId": "4028804069e793a10169e79a3ef30004",
        "processorId": "4028800869525e960169557a35920000",
        "processTime": "2019-04-04 17:09:14",
        "processStage": "CASHIER",
        "processResult": "APPROVED",
        "processStatus": "COMPLETE",
        "note": "同意",
        "nextBillProcessId": null
      }
    ]
  }
]
```

### 6. 获取公司财务单据列表
#### 描述
查询公司财务单据列表
#### 请求
POST /finace/bill/billList
```
body参数:
{
"biztypes":["YS","YF"] //可选参数，单据类型，可以是多值
"pageNum":1, //可选参数，页数，从1开始
"pageSize":10 //可选参数， 页大小
"startDate": //可选参数 开始日期 格式：yyyy-MM-dd
"endDate": //可选参数 结束日期 格式：yyyy-MM-dd
"isDesc"://可选参数 是否倒叙 true:倒序 ,false:升序（默认）
}
```
#### 响应
```
同上，即5. 获取我的审批列表 接口返回对象
```
<hr />


### 7. 导出公司财务单据列表
#### 描述
导出公司财务单据列表
#### 请求
POST /finace/bill/billList/export
```
body参数:
{
"biztypes":[] //可选参数，单据类型，可以是多值
"pageNum":1, //可选参数，页数，从1开始
"pageSize":10 //可选参数， 页大小
"startDate": //可选参数 开始日期 格式：yyyy-MM-dd
"endDate": //可选参数 结束日期 格式：yyyy-MM-dd
"isDesc"://可选参数 是否倒叙 true:倒序 ,false:升序（默认）
}
```
#### 响应
```json
200
```
<hr />

### 8. 获取我发起的审批列表
#### 描述
获取我发起的审批列表
#### 请求
POST /finace/bill/myLaunch
```
{
"pageNum":1, //可选参数，页数，从1开始
"pageSize":10 //可选参数， 页大小
"isProcessing: false // 可选参数,是否被审批 true:已审批 ,false:待审批
 }
 ```
 
#### 响应
```
同上，即5. 获取我的审批列表 接口返回对象
```
<hr />


### 9. 财务单据审批处理
#### 描述
对待审批的财务单据进行审批
#### 请求
POST /finace/bill/process
```json
{
  "approveAction": "PASSED，处理操作，请查看枚举说明",
  "approveId": "审批人",
  "billId": "单据id",
  "note": "审批意见说明"
}
```
```
枚举对象说明：
approveAction：审批操作
    PASSED("通过"),
    REJECTED("驳回"),
    CANCELED("撤回")
```
#### 响应
```json
200
```
<hr />


### 10. 财务单据结果处理
#### 描述
财务单据结果处理
#### 请求
POST /finace/bill/process/confirm
```json
{
  "billId": "单据ID",
  "conformAction": "DONE，结果处理操作，请查看枚举说明",
  "newBizDate": "2019-04-07 12:21:31 ，可选参数，新业务日期"
}
```
```
参数说明:
conformAction:结果处理类型
    DONE("已完成"),
    DELAY("驳回"),
    CANCELED("撤回"),
    DEL("删除"),
    CANCELED_DEL("撤回并删除")
```
#### 响应
```json
200
```
<hr />

### 11. 财务单据详细搜索
#### 描述
财务单据详细搜索
#### 请求
POST /finace/bill/search
```json
{
  "amount": 0,
  "approverId": "审批人id",
  "auditorId": "审核人id",
  "bizDate": "2019-04-07 08:14:00,业务日期",
  "bizType": "YS，单据类别",
  "cashierId": "出纳人id",
  "category": "类别",
  "chargeType": "记账方式",
  "companyId": "公司id",
  "customer": "客户",
  "dealing": "来往业务",
  "keyword": "关键词",
  "listerId": "制表人id",
  "num": 0,
  "operatorId": "经办人id",
  "payType": "结账方式",
  "price": 0,
  "remark": "摘要(用途)",
  "subject": "科目",
  "title": "自定义财务录入标题",
  "voucherNo": "凭证号",
  "voucherWord": "凭证字"
}
```

#### 响应
```
同 1、获取财务单据列表 接口
```
<hr />


### 12. 公司总账余额
#### 描述
公司总账余额  
#### 请求
 GET /finace/bill/sum/balance
#### 响应
```json
{
  "companyId": "公司id",
  "calTime": "2019-04-07 17:25:05，计算时间",
  "bizDate": "2019-04-07，业务日期",
  "debitAmount": "当日收入金额",
  "creditAmount": "当日支出金额" ,
  "customAmount": "当日记账金额(自定义财务录入金额)",
  "curBalance": "当日余额",
  "totalAmt": "公司余额",
  "totalCustomAmt": "公司记账金额"
}
```
```
  "debitAmount": ：今日收入金额
  "creditAmount": 今日支出金额,
  "customAmount": 今日自定义金额,
  "curBalance": 今日收支结余,
  "totalAmt": 总账结余,
  "totalCustomAmt":总账自定义金额 
```
<hr />

### 13. 获取公司总账列表
#### 描述
获取财务总账列表，支持分页
#### 请求
POST /finace/bill/sum/basesearch
```
{
    "pageNum":, //可选参数，页数，从1开始
    "pageSize":10 //可选参数， 页大小
    "dcFlag": "DEBIT，必填参数 借贷标记 请参考枚举类型说明",
    "startDate": "2019-04-03 ，可选参数 开始日期 格式yyyy-MM-dd",
    "endDate": "2019-04-03 ，可选参数 结束日期格式yyyy-MM-dd"
 
}
```
#### 响应
```json
[
  {
    "id": "4028804069e793a10169e79bff08000a",
    "createTime": "2019-04-04 17:09:14",
    "bizType": "YS，单据类别",
    "bizDate": "2019-04-03 12:10:21 业务日期",
    "amount": 1000.01,
    "dcFlag": "DEBIT，借贷标记",
    "companyId": "402880086951cc28016951d35f140000",
    "billId": "单据id",
    "bizNo": "业务编号",
    "note": "摘要(用途)"
  }
]
```
<hr />


### 14. 导出公司总账列表
#### 描述
导出公司总账列表
#### 请求
POST /finace/bill/sum/basesearch/export
```
{
    "pageNum":, //可选参数，页数，从1开始
    "pageSize":10 //可选参数， 页大小
    "dcFlag": "DEBIT，必填参数 借贷标记 请参考枚举类型说明",
    "startDate": "2019-04-03 ，可选参数 开始日期 格式yyyy-MM-dd",
    "endDate": "2019-04-03 ，可选参数 结束日期格式yyyy-MM-dd"
 
}
```
#### 响应
```json
200
```
<hr />

### 15. 公司总账详细搜索
#### 描述
公司总账详细搜索
#### 请求
POST /finace/bill/sum/search
```
同 11. 财务单据详细搜索 ，请参考
```
#### 响应
```json
[
  {
    "id": "4028804069e793a10169e79bff08000a",
    "createTime": "2019-04-04 17:09:14",
    "bizType": "YS，单据类型，请查看枚举说明",
    "bizDate": "2019-04-03 12:10:21，业务日期",
    "amount": 1000.01,
    "dcFlag": "DEBIT，借贷标记，请查看枚举说明",
    "companyId": "402880086951cc28016951d35f140000",
    "billId": "单据id",
    "bizNo": "单据编号",
    "note": "摘要(用途)"
  }
]
```
<hr />


### 16. 获取公司总账详情(by 总账id)
#### 描述
  获取公司总账详情(by 总账id)
#### 请求
GET /finace/bill/sum/{id}
#### 响应
```
同上，即5. 获取我的审批列表 接口返回对象
```
```json
{
     "id": "4028804069e793a10169e79a3ef30004",
     "createTime": "2019-04-04 17:07:19",
     "bizType": "YS",
     "title": "",
     "bizNo": "YS4028804069e793a10169e79a3ef30004",
     "dcFlag": "DEBIT",
     "amount": 1000.01,
     "payType": "微信支付",
     "price": 20,
     "num": 200,
     "voucherWord": "凭证字11",
     "voucherNo": "xx00000",
     "category": "出货",
     "bizDate": "2019-04-03 12:10:21",
     "dealing": "xx往来",
     "chargeType": "记账方式1",
     "keyword": "出货收款",
     "photos": [
       ""
     ],
     "customer": "深圳某品牌",
     "remark": "我的应收",
     "subject": "科目xx",
     "companyId": "402880086951cc28016951d35f140000",
     "operatorId": "402880086950ab4c016950b1a4460002",
     "listerId": "402880086950ab4c016950b1a4460002",
     "auditorId": "40288008695210f801695218b7d60000",
     "approverId": "4028800869524c8c0169524dfe2b0000",
     "cashierId": "4028800869525e960169557a35920000",
     "billProcessId": "4028804069e793a10169e79a3f2f0009",
     "status": "PASSED",
     "billProcessDTOList": [
       {
         "id": "4028804069e793a10169e79a3f2d0005",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "402880086950ab4c016950b1a4460002",
         "processTime": null,
         "processStage": "LISTER",
         "processResult": "APPROVING",
         "processStatus": "NOTSTART",
         "note": null,
         "nextBillProcessId": null
       },
       {
         "id": "4028804069e793a10169e79a3f2e0006",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "402880086950ab4c016950b1a4460002",
         "processTime": null,
         "processStage": "OPERATOR",
         "processResult": "APPROVING",
         "processStatus": "NOTSTART",
         "note": null,
         "nextBillProcessId": null
       },
       {
         "id": "4028804069e793a10169e79a3f2e0007",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "40288008695210f801695218b7d60000",
         "processTime": "2019-04-04 17:08:39",
         "processStage": "AUDITOR",
         "processResult": "APPROVED",
         "processStatus": "COMPLETE",
         "note": "同意",
         "nextBillProcessId": "4028804069e793a10169e79a3f2f0008"
       },
       {
         "id": "4028804069e793a10169e79a3f2f0008",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "4028800869524c8c0169524dfe2b0000",
         "processTime": "2019-04-04 17:09:01",
         "processStage": "APPROVER",
         "processResult": "APPROVED",
         "processStatus": "COMPLETE",
         "note": "同意",
         "nextBillProcessId": "4028804069e793a10169e79a3f2f0009"
       },
       {
         "id": "4028804069e793a10169e79a3f2f0009",
         "createTime": "2019-04-04 17:07:19",
         "billId": "4028804069e793a10169e79a3ef30004",
         "processorId": "4028800869525e960169557a35920000",
         "processTime": "2019-04-04 17:09:14",
         "processStage": "CASHIER",
         "processResult": "APPROVED",
         "processStatus": "COMPLETE",
         "note": "同意",
         "nextBillProcessId": null
       }
     ]
   }
```
<hr />


### 17. 获取财务单据详情(by 财务单据id)
#### 描述
  获取财务单据详情(by 财务单据id)
#### 请求
GET /finace/bill/{id}
#### 响应
```
同 16.获取财务总账详情(by 财务总账id) 接口
```
<hr />
